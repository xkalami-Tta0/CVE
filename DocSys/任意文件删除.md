# Vulnerability Introduction

The /Doc/deleteDoc.do interface of DocSystem has an arbitrary file deletion vulnerability, which allows attackers to delete any file on the server.

# Vulnerability analysis

Vulnerable class fileï¼šsrc/com/DocSystem/controller/DocController.java

path and name are passed into the doc object through buildBasicDoc

![image-20250929010939980](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929010939980.2h8oiw8j2n.webp)

Method for tracking deleted files: deleteDoc

![image-20250929011032896](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929011032896.73ubjl72q6.webp)

Continue tracing to the deleteDoc_FSM method

![image-20250929011132735](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929011132735.2a5gngmdn1.webp)

Locate the deletion method and follow up

![image-20250929011624873](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929011624873.5fkymegsjw.webp)

The path and name are concatenated into the localDocPath object, and the FileUtil.delFileOrDir method is called

![image-20250929011746600](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929011746600.7snl3lulqj.webp)

delFileOrDir performs the operation of recursively deleting files without restrictions on file names or file paths, allowing the deletion of any file.

![image-20250929011758818](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929011758818.1apdaajmh6.webp)

# Vulnerability reproduction

Delete the a.jsp file located in the root directory

![image-20250929012136907](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929012136907.8dx8pwp215.webp)

construct poc

![image-20250929012321481](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929012321481.1e8z80cp6w.webp)

Successfully deleted

![image-20250929012336751](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929012336751.26lupqtax3.webp)
