# Vulnerability Introduction

The /Doc/uploadDoc.do interface of DocSystem allows for arbitrary file uploads.，An attacker can construct an upload interface to upload any malicious file to the target server.

# Vulnerability analysis

Vulnerable class file：src/com/DocSystem/controller/DocController.java

path and name are passed into the doc object through buildBasicDoc

![image-20250929004037817](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929004037817.86u0ufpl5s.webp)

The entire method does not perform any verification on path and name, and calls addDoc to upload the file.

![image-20250929004223499](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/image-20250929004223499.41yfibskeh.webp)

Follow up the addDoc method, and call addDoc_FSM to continue following up

![image.png](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/1759073844477-53ca2464-5d0b-409b-b9db-e84fe1224e9f.99tq5blr5u.webp)

Call updateRealDoc to handle file upload and follow up

![image.png](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/1759074298795-2f3cb228-1055-41c5-af88-4af75d814c2b.7pnzdayzf.webp)

In updateRealDoc, the path and name are obtained without any verification, and then the uploaded file is saved using FileUtil.saveFile.

![image.png](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/1759074527430-02644c8b-e868-4200-92b7-ed12d89d6a23.3uv7mw6wbp.webp)

# Vulnerability reproduction

Construct POC upload

![image.png](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/1759075463181-62034a10-3c3c-459b-8874-1a68bf3b4eb9.54y4t7p00j.webp)

Successfully uploaded to the root directory

![image.png](https://github.com/xkalami-Tta0/picx-images-hosting/raw/master/DocSys/1759075479273-36467b76-2012-4d5b-a37f-8bd7f99c93d1.361y2vjm48.webp)
